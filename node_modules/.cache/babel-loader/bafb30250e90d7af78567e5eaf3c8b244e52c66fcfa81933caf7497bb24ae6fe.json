{"ast":null,"code":"import{useState}from'react';import{DndContext,DragOverlay,closestCorners,KeyboardSensor,PointerSensor,useSensor,useSensors}from'@dnd-kit/core';import{sortableKeyboardCoordinates}from'@dnd-kit/sortable';import{KanbanColumn}from'./KanbanColumn';import{KanbanCard}from'./KanbanCard';import{STATUS_ORDER}from'../../utils/constants';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export function KanbanBoard(_ref){let{tasks,assigneesByTask={},onStatusChange,onEdit,onDelete,onAssign,onComment}=_ref;const[activeId,setActiveId]=useState(null);const sensors=useSensors(useSensor(PointerSensor,{activationConstraint:{distance:8}}),useSensor(KeyboardSensor,{coordinateGetter:sortableKeyboardCoordinates}));const tasksByStatus=STATUS_ORDER.reduce((acc,status)=>{acc[status]=tasks.filter(t=>t.status===status);return acc;},{});const activeTask=activeId?tasks.find(t=>t.id===activeId):null;const handleDragStart=event=>{setActiveId(event.active.id);};const handleDragEnd=event=>{const{active,over}=event;setActiveId(null);if(!over)return;const activeTask=tasks.find(t=>t.id===active.id);if(!activeTask)return;const overId=over.id;let newStatus=null;if(STATUS_ORDER.includes(overId)){newStatus=overId;}else{const overTask=tasks.find(t=>t.id===overId);if(overTask){newStatus=overTask.status;}}if(newStatus&&activeTask.status!==newStatus){onStatusChange===null||onStatusChange===void 0?void 0:onStatusChange(activeTask.id,newStatus);}};const handleDragOver=event=>{const{active,over}=event;if(!over)return;const activeTask=tasks.find(t=>t.id===active.id);if(!activeTask)return;const overId=over.id;let targetStatus=null;if(STATUS_ORDER.includes(overId)){targetStatus=overId;}else{const overTask=tasks.find(t=>t.id===overId);if(overTask){targetStatus=overTask.status;}}if(targetStatus&&activeTask.status!==targetStatus){onStatusChange===null||onStatusChange===void 0?void 0:onStatusChange(activeTask.id,targetStatus);}};return/*#__PURE__*/_jsxs(DndContext,{sensors:sensors,collisionDetection:closestCorners,onDragStart:handleDragStart,onDragEnd:handleDragEnd,onDragOver:handleDragOver,children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\",children:STATUS_ORDER.map(status=>/*#__PURE__*/_jsx(KanbanColumn,{id:status,tasks:tasksByStatus[status],children:tasksByStatus[status].map(task=>/*#__PURE__*/_jsx(KanbanCard,{task:task,assignees:assigneesByTask[task.id]||[],onEdit:onEdit,onDelete:onDelete,onAssign:onAssign,onComment:onComment},task.id))},status))}),/*#__PURE__*/_jsx(DragOverlay,{children:activeTask?/*#__PURE__*/_jsx(\"div\",{className:\"rotate-3 shadow-lifted\",children:/*#__PURE__*/_jsx(KanbanCard,{task:activeTask,assignees:assigneesByTask[activeTask.id]||[]})}):null})]});}","map":{"version":3,"names":["useState","DndContext","DragOverlay","closestCorners","KeyboardSensor","PointerSensor","useSensor","useSensors","sortableKeyboardCoordinates","KanbanColumn","KanbanCard","STATUS_ORDER","jsx","_jsx","jsxs","_jsxs","KanbanBoard","_ref","tasks","assigneesByTask","onStatusChange","onEdit","onDelete","onAssign","onComment","activeId","setActiveId","sensors","activationConstraint","distance","coordinateGetter","tasksByStatus","reduce","acc","status","filter","t","activeTask","find","id","handleDragStart","event","active","handleDragEnd","over","overId","newStatus","includes","overTask","handleDragOver","targetStatus","collisionDetection","onDragStart","onDragEnd","onDragOver","children","className","map","task","assignees"],"sources":["/Users/mohanadbahammam/Desktop/task-frontend/src/components/kanban/KanbanBoard.jsx"],"sourcesContent":["import { useState } from 'react';\nimport {\n  DndContext,\n  DragOverlay,\n  closestCorners,\n  KeyboardSensor,\n  PointerSensor,\n  useSensor,\n  useSensors,\n} from '@dnd-kit/core';\nimport { sortableKeyboardCoordinates } from '@dnd-kit/sortable';\nimport { KanbanColumn } from './KanbanColumn';\nimport { KanbanCard } from './KanbanCard';\nimport { STATUS_ORDER } from '../../utils/constants';\n\nexport function KanbanBoard({\n  tasks,\n  assigneesByTask = {},\n  onStatusChange,\n  onEdit,\n  onDelete,\n  onAssign,\n  onComment,\n}) {\n  const [activeId, setActiveId] = useState(null);\n\n  const sensors = useSensors(\n    useSensor(PointerSensor, {\n      activationConstraint: {\n        distance: 8,\n      },\n    }),\n    useSensor(KeyboardSensor, {\n      coordinateGetter: sortableKeyboardCoordinates,\n    })\n  );\n\n  const tasksByStatus = STATUS_ORDER.reduce((acc, status) => {\n    acc[status] = tasks.filter((t) => t.status === status);\n    return acc;\n  }, {});\n\n  const activeTask = activeId ? tasks.find((t) => t.id === activeId) : null;\n\n  const handleDragStart = (event) => {\n    setActiveId(event.active.id);\n  };\n\n  const handleDragEnd = (event) => {\n    const { active, over } = event;\n    setActiveId(null);\n\n    if (!over) return;\n\n    const activeTask = tasks.find((t) => t.id === active.id);\n    if (!activeTask) return;\n\n    const overId = over.id;\n    let newStatus = null;\n\n    if (STATUS_ORDER.includes(overId)) {\n      newStatus = overId;\n    } else {\n      const overTask = tasks.find((t) => t.id === overId);\n      if (overTask) {\n        newStatus = overTask.status;\n      }\n    }\n\n    if (newStatus && activeTask.status !== newStatus) {\n      onStatusChange?.(activeTask.id, newStatus);\n    }\n  };\n\n  const handleDragOver = (event) => {\n    const { active, over } = event;\n    if (!over) return;\n\n    const activeTask = tasks.find((t) => t.id === active.id);\n    if (!activeTask) return;\n\n    const overId = over.id;\n    let targetStatus = null;\n\n    if (STATUS_ORDER.includes(overId)) {\n      targetStatus = overId;\n    } else {\n      const overTask = tasks.find((t) => t.id === overId);\n      if (overTask) {\n        targetStatus = overTask.status;\n      }\n    }\n\n    if (targetStatus && activeTask.status !== targetStatus) {\n      onStatusChange?.(activeTask.id, targetStatus);\n    }\n  };\n\n  return (\n    <DndContext\n      sensors={sensors}\n      collisionDetection={closestCorners}\n      onDragStart={handleDragStart}\n      onDragEnd={handleDragEnd}\n      onDragOver={handleDragOver}\n    >\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        {STATUS_ORDER.map((status) => (\n          <KanbanColumn key={status} id={status} tasks={tasksByStatus[status]}>\n            {tasksByStatus[status].map((task) => (\n              <KanbanCard\n                key={task.id}\n                task={task}\n                assignees={assigneesByTask[task.id] || []}\n                onEdit={onEdit}\n                onDelete={onDelete}\n                onAssign={onAssign}\n                onComment={onComment}\n              />\n            ))}\n          </KanbanColumn>\n        ))}\n      </div>\n\n      <DragOverlay>\n        {activeTask ? (\n          <div className=\"rotate-3 shadow-lifted\">\n            <KanbanCard\n              task={activeTask}\n              assignees={assigneesByTask[activeTask.id] || []}\n            />\n          </div>\n        ) : null}\n      </DragOverlay>\n    </DndContext>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}